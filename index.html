<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Deepak Options Journal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="style.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins&display=swap" rel="stylesheet">
</head>
<body>

  <header>
    Deepak Options Journal
  </header>

  <div class="container">
    <h2>Add Trade</h2>
    <form id="tradeForm">
      <input type="text" id="symbol" placeholder="Symbol" required>
      <input type="number" id="entry" placeholder="Entry Price" required>
      <input type="number" id="exit" placeholder="Exit Price" required>
      <input type="number" id="qty" placeholder="Quantity" required>
      <select id="direction" required>
        <option value="">Direction</option>
        <option value="Long">Long</option>
        <option value="Short">Short</option>
      </select>
      <button type="submit">Add Trade</button>
    </form>

    <h2>Trades</h2>
    <table>
      <thead>
        <tr>
          <th>Symbol</th>
          <th>Entry</th>
          <th>Exit</th>
          <th>Qty</th>
          <th>Direction</th>
          <th>PnL</th>
        </tr>
      </thead>
      <tbody id="tradeTable"></tbody>
    </table>

    <h2>Dashboard</h2>
    <p id="netPnl"><strong>Net PnL:</strong> ₹0</p>
    <p id="winRate"><strong>Win Rate:</strong> 0%</p>
    <p id="avgR"><strong>Avg R:</strong> 0</p>
  </div>

  <script>
    const form = document.getElementById('tradeForm');
    const table = document.getElementById('tradeTable');
    const netPnlEl = document.getElementById('netPnl');
    const winRateEl = document.getElementById('winRate');
    const avgREl = document.getElementById('avgR');

    let trades = [];

    form.addEventListener('submit', function(e) {
      e.preventDefault();

      const symbol = document.getElementById('symbol').value.trim();
      const entry = parseFloat(document.getElementById('entry').value);
      const exit = parseFloat(document.getElementById('exit').value);
      const qty = parseInt(document.getElementById('qty').value);
      const direction = document.getElementById('direction').value;

      if (!symbol || isNaN(entry) || isNaN(exit) || isNaN(qty) || !direction) return;

      const pnl = direction === 'Long' ? (exit - entry) * qty : (entry - exit) * qty;
      const r = pnl / (Math.abs(entry - exit) * qty);

      const trade = { symbol, entry, exit, qty, direction, pnl, r };
      trades.push(trade);

      const row = document.createElement('tr');
      row.innerHTML = `
        <td>${symbol}</td>
        <td>${entry}</td>
        <td>${exit}</td>
        <td>${qty}</td>
        <td>${direction}</td>
        <td style="color:${pnl >= 0 ? 'lime' : 'red'}">₹${pnl.toFixed(2)}</td>
      `;
      table.appendChild(row);

      updateDashboard();
      form.reset();
    });

    function updateDashboard() {
      const totalPnl = trades.reduce((sum, t) => sum + t.pnl, 0);
      const wins = trades.filter(t => t.pnl > 0).length;
      const winRate = trades.length ? (wins / trades.length) * 100 : 0;
      const avgR = trades.length ? trades.reduce((sum, t) => sum + t.r, 0) / trades.length : 0;

      netPnlEl.innerHTML = `<strong>Net PnL:</strong> ₹${totalPnl.toFixed(2)}`;
      winRateEl.innerHTML = `<strong>Win Rate:</strong> ${winRate.toFixed(1)}%`;
      avgREl.innerHTML = `<strong>Avg R:</strong> ${avgR.toFixed(2)}`;
    }
  </script>

</body>
</html>
